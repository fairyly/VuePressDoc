(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{293:function(n,s,a){"use strict";a.r(s);var t=a(0),e=Object(t.a)({},function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"_3-2-4-防抖和节流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-防抖和节流","aria-hidden":"true"}},[n._v("#")]),n._v(" 3.2.4 防抖和节流")]),n._v(" "),a("h1",{attrs:{id:"理解js的节流、防抖及使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理解js的节流、防抖及使用场景","aria-hidden":"true"}},[n._v("#")]),n._v(" 理解JS的节流、防抖及使用场景")]),n._v(" "),a("p",[n._v("以下场景往往由于事件频繁被触发，因而频繁执行DOM操作、资源加载等重行为，导致UI停顿甚至浏览器崩溃。")]),n._v(" "),a("ul",[a("li",[a("p",[n._v("1.window对象的resize、scroll事件")])]),n._v(" "),a("li",[a("p",[n._v("2.拖拽时的mousemove事件")])]),n._v(" "),a("li",[a("p",[n._v("3.射击游戏中的mousedown、keydown事件")])]),n._v(" "),a("li",[a("p",[n._v("4.文字输入、自动完成的keyup事件")])])]),n._v(" "),a("h2",{attrs:{id:"函数防抖-debounce"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数防抖-debounce","aria-hidden":"true"}},[n._v("#")]),n._v(" 函数防抖(debounce)")]),n._v(" "),a("blockquote",[a("p",[n._v("在事件被触发n秒后再执行回调，如果在这n秒内又被触发，则重新计时。")])]),n._v(" "),a("h3",{attrs:{id:"demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo","aria-hidden":"true"}},[n._v("#")]),n._v(" demo")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("//模拟一段ajax请求\nfunction ajax(content) {\n  console.log('ajax request ' + content)\n}\n\nlet inputa = document.getElementById('unDebounce')\n\ninputa.addEventListener('keyup', function (e) {\n    ajax(e.target.value)\n})\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br")])]),a("h3",{attrs:{id:"优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化","aria-hidden":"true"}},[n._v("#")]),n._v(" 优化")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("//模拟一段ajax请求\nfunction ajax(content) {\n  console.log('ajax request ' + content)\n}\n\nfunction debounce(fun, delay) {\n    return function (args) {\n        let that = this\n        let _args = args\n        clearTimeout(fun.id)\n        fun.id = setTimeout(function () {\n            fun.call(that, _args)\n        }, delay)\n    }\n}\n    \nlet inputb = document.getElementById('debounce')\n\nlet debounceAjax = debounce(ajax, 500)\n\ninputb.addEventListener('keyup', function (e) {\n        debounceAjax(e.target.value)\n    })\n\n\n可以看到，我们加入了防抖以后，当你在频繁的输入时，并不会发送请求，只有当你在指定间隔内没有输入时，才会执行函数。\n如果停止输入但是在指定间隔内又输入，会重新触发计时。\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br")])]),a("ul",[a("li",[n._v("demo-2")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('window.onscroll = function(){\n  //lazyload();\n  debounce(lazyload,window);\n};\nfunction debounce(method,context){\n  clearTimeout(method.timeout);\n  method.timeout = setTimeout(function(){\n    method.call(context);\n  },500);\n}\nfunction lazyload(){\n  console.log("scroll执行了"+scrollnum);\n}\n\n\n链接：https://www.jianshu.com/p/4f3e2c8f5e95\n\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br")])]),a("h2",{attrs:{id:"函数节流-throttle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数节流-throttle","aria-hidden":"true"}},[n._v("#")]),n._v(" 函数节流(throttle)")]),n._v(" "),a("blockquote",[a("p",[n._v("规定在一个单位时间内，只能触发一次函数。如果这个单位时间内触发多次函数，只有一次生效。")])]),n._v(" "),a("h3",{attrs:{id:"demo-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#demo-2","aria-hidden":"true"}},[n._v("#")]),n._v(" demo")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("function throttle(fun, delay) {\n        let last, deferTimer\n        return function (args) {\n            let that = this\n            let _args = arguments\n            let now = +new Date()\n            if (last && now < last + delay) {\n                clearTimeout(deferTimer)\n                deferTimer = setTimeout(function () {\n                    last = now\n                    fun.apply(that, _args)\n                }, delay)\n            }else {\n                last = now\n                fun.apply(that,_args)\n            }\n        }\n    }\n\n    let throttleAjax = throttle(ajax, 1000)\n\n    let inputc = document.getElementById('throttle')\n    inputc.addEventListener('keyup', function(e) {\n        throttleAjax(e.target.value)\n    })\n    \n可以看到，我们在不断输入时，ajax会按照我们设定的时间，每1s执行一次。\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br")])]),a("p",[n._v("不管我们设定的执行时间间隔多小，总是1s内只执行一次。")]),n._v(" "),a("ul",[a("li",[n._v("demo-2")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("function throttle2(method, delay, time) {\n  var timeout,startTime = new Date();\n  return function() {\n    var context = this,\n    args = arguments,\n    curTime = new Date();\n    clearTimeout(timeout);\n    // 如果达到了规定的触发时间间隔，触发 handler\n    if (curTime - startTime >= time) {\n      method.apply(context, args);\n      startTime = curTime;\n      // 没达到触发间隔，重新设定定时器\n    } else {\n      timeout = setTimeout(method, delay);\n    }\n};\n\n链接：https://www.jianshu.com/p/4f3e2c8f5e95\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("h2",{attrs:{id:"sum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sum","aria-hidden":"true"}},[n._v("#")]),n._v(" sum")]),n._v(" "),a("ul",[a("li",[n._v("函数防抖和函数节流都是防止某一时间频繁触发，但是这两兄弟之间的原理却不一样。")]),n._v(" "),a("li",[n._v("函数防抖是某一段时间内只执行一次，而函数节流是间隔时间执行。")])]),n._v(" "),a("h2",{attrs:{id:"结合应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结合应用场景","aria-hidden":"true"}},[n._v("#")]),n._v(" 结合应用场景")]),n._v(" "),a("ul",[a("li",[a("p",[n._v("debounce")]),n._v(" "),a("ul",[a("li",[n._v("search搜索联想，用户在不断输入值时，用防抖来节约请求资源。")]),n._v(" "),a("li",[n._v("window触发resize的时候，不断的调整浏览器窗口大小会不断的触发这个事件，用防抖来让其只触发一次")])])]),n._v(" "),a("li",[a("p",[n._v("throttle")]),n._v(" "),a("ul",[a("li",[n._v("鼠标不断点击触发，mousedown(单位时间内只触发一次)")]),n._v(" "),a("li",[n._v("监听滚动事件，比如是否滑到底部自动加载更多，用throttle来判断")])])])]),n._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[n._v("#")]),n._v(" 参考")]),n._v(" "),a("ul",[a("li",[a("p",[n._v("https://juejin.im/post/5b8de829f265da43623c4261")])]),n._v(" "),a("li",[a("p",[n._v("http://www.cnblogs.com/zichi/p/5331426.html")])]),n._v(" "),a("li",[a("p",[n._v("https://davidwalsh.name/javascript-debounce-function")])]),n._v(" "),a("li",[a("p",[n._v("https://css-tricks.com/the-difference-between-throttling-and-debouncing/")])]),n._v(" "),a("li",[a("p",[n._v("https://ict.ken.be/javascript-debounce-vs-throttle-function")])]),n._v(" "),a("li",[a("p",[n._v("https://stackoverflow.com/questions/25991367/difference-between-throttling-and-debouncing-a-function")])]),n._v(" "),a("li",[a("p",[n._v("https://remysharp.com/2010/07/21/throttling-function-calls")])]),n._v(" "),a("li",[a("p",[n._v("https://segmentfault.com/a/1190000008768202")])]),n._v(" "),a("li",[a("p",[n._v("http://www.alloyteam.com/2012/11/javascript-throttle/")])]),n._v(" "),a("li",[a("p",[a("a",{attrs:{href:""}})])])])])},[],!1,null,null,null);s.default=e.exports}}]);